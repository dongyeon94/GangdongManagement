<!doctype html>
<html lang="en" 
		xmlns:th="http://www.thymeleaf.org" 
		xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head> 
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
	<link rel="stylesheet" th:href="@{/css/layout.css}">
	<link rel="stylesheet" th:href="@{/css/animation.css}">
	<title>Gangdong</title>
</head>

<body style="background-color: #eaeef3">

<header class="navbar navbar-white">
	<div>
		<img id="logo" alt="logo" th:src="@{/img/gangdongLoggorImg.PNG}"  width="40" height="40">
		<img id="logo" alt="logo" th:src="@{/img/gangdongLoggorText.PNG}"  width="100" height="40">
	</div>	
</header>

<nav class="navbar" style="background-color: #17a2b8;">
	<button>개발자 메일 보내기</button>
</nav>


<div class="mainContent" >
	<div class="head-text-bar">
		<h2><div id="today-time"></div></h2>
	</div>	
	
	<div class="state-overview">
		<div class="row">
			<div class="col-xl-3 col-md-6 col-12"> 
				<div class="info-box bg-b-orange">
					<span><img id="logo" alt="logo" th:src="@{/img/king.png}"  width="40" height="40"></span>
					<span id="currentMonth"></span> 
					<span>벙신</span>
				</div> 			
			</div>
			<div class="col-xl-3 col-md-6 col-12"> 
				<div class="info-box bg-b-purple"> 
					<span>현재 진행중인 벙</span> 
				</div> 
			</div>
			<div class="col-xl-3 col-md-6 col-12"> 
				<div class="info-box bg-b-cyan">   
					<span>준비중입니다.</span> 
				</div> 
			</div>
			<div class="col-xl-3 col-md-6 col-12"> 
				<div class="info-box bg-b-gray">  
					<span>준비중입니다.</span> 
				</div> 
			</div>
		</div>
	</div>


	<div class="row">		
		<div class="col-sm-8">
			<div class="card card-box">			
				<div class="">
					<form action="/" method="post" style="float: left;">
						<input  id="selectedDate" name="selectedDate" type="month" th:value="${curruentdata}">
						<!-- <input  id="selectedDate" name="selectedDate" type="month" > -->
						<button type="submit" onclick="searchUserPartyTimes()">검색</button>
					</form>
				</div>
				<div class="chart-wrapper">
					<div class="Chart" th:fragment="chart" style="">	
						<canvas id="myChart" height="300" width="1200"></canvas>			
					</div>
					<!-- <canvas id="myChartAxis" height="300" width="0"></canvas> --> 
				</div>	
			</div>
		</div>
		
		<div class="col-sm-4">
			<div class="card card-box">
				<div id="piechart" style="width: 100%; height: 100%;"></div>
			</div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-md-12 col-sm-12">
			<div class="card card-box">
				<h2> 공지 </h2>
				<div class="member-info table">
					<table class="table-inner-style" style="text-align: left;">
						<tr>
							<td>생일자 있습니다.</td>
						</tr>
						<tr>
							<td>9월 공지</td>
						</tr>
					</table>					
				</div>
			</div>			
		</div>		
	</div>
	
	<div class="row">
		<div class="col-md-12 col-sm-12"> 
			<div class="card card-box">
				<h2>
					<img id="logo" alt="logo" th:src="@{/img/king.png}"  width="40" height="40">
					벙 신 계 보
					<img id="logo" alt="logo" th:src="@{/img/king.png}"  width="40" height="40">
				</h2>
				<div  class="member-info table">			
					<table class="table-inner-style">
						<tr th:each="bestUser, i : ${BestUser}">
							<td th:text="${bestUser.date}"></td>
							<td th:text="${bestUser.nickname}"></td>
						</tr>
					</table>
				</div>
		 	</div>		
		</div>		
	</div>


<!-- 
	<div class="row">
		<div class="col-md-12 col-sm-12">
			<div class="card card-box">
				<div class="ADD_Party" th:fragment="ADDPart" >
					<form class="ADDDateTimes" action="" style="float: left;">
						<div>
							<input type="date" name="datetimes"> 
							<label for="cars">Choose a times:</label> 
							<select class="Times-Select" name="times" id="times">
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
							</select> 
						</div>
					</form>
					<form class="userchecked" action="">
						<div style="height: 50px;"></div>
						<div class="checkboxContainer">				
							<div class="table member-table">
								<table class="checkboxTable table-inner-style member-table-header">
									<thead>
										<tr>
											<th class="fixed-header">닉네임</th>
											<th class="fixed-header">참여확인</th>
										</tr>
									</thead>
									<tbody>
										<tr th:each="membetList : ${membetList}" th:object="${membetList}">
											<td th:text="${membetList.nickName}"></td>
											<td><input type="checkbox" class="membercheck" th:value="${membetList.id}" th:name="memberList"></td>
										</tr>
									</tbody>
								</table>
							</div>									
						</div>
					</form>
					<button class="btn btn-primary" style="width:100%; margin-top:2%;" type="button" onclick="addPartyAjax()"> add party </button>			
				</div>
			</div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-md-8 col-sm-8">
			<div class="card card-box">
				<div class="member-info table member-table">					
					<table class="table-inner-style member-table-header">
						<thead>
							<tr>
								<th class="fixed-header">닉네임</th>
								<th class="fixed-header">나이</th>
								<th class="fixed-header">지역</th>
								<th class="fixed-header">가입 날짜</th>
								<th class="fixed-header">삭제여부</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="membetList : ${membetList}" th:object="${membetList}">							
								<form class="deleteUser">
									<input type="hidden" id="memberIdKey" th:value="${membetList.id}">							
									<td th:text="${membetList.nickName}"></td>
									<td th:text="${membetList.age}"></td>
									<td th:text="${membetList.memo}"></td>
									<td th:text="${membetList.joinDate}"></td>
									<td><input type="checkbox" class="membercheck"  th:value="${membetList.id}" th:name="memberList"></td>
								</form>
							</tr>
						</tbody>
					</table>
				</div>
				<button class="btn btn-primary" type="button" style="margin: 5% 3% 5% 3%;" onclick="deleteMemberAjax()">삭제 </button>	
			</div>
		</div>
		
		<div class="col-md-4 col-sm-12 col-12">
			<div class="card card-box">
				<div class="Add_Member">
					<div>
						<label for="exampleInputEmail1">ADD Member</label> 
						<small id="emailHelp" class="form-text text-muted">We'll write text ['지코/29/성내/남'] form </small> 
						<br/>
						<form class="addMember" action="/signup" method="post" onsubmit="return addMemberAjax()">
							<input type="text" name="user" style="width:90%;"> 
							<br/><br/>
							<button type="submit" class="btn btn-primary" style="width:90%;"> ADD Member </button>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>	
	
	 -->
	
</div>

</body>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0" type="text/javascript"></script>
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous" type="text/javascript"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous" type="text/javascript"></script>
<script type="text/javascript" src="https://rawgit.com/nnnick/Chart.js/v1.0.2/Chart.min.js"></script> 

<script type="text/javascript" th:src="@{/js/timer.js}"></script>
<script type="text/javascript" th:src="@{/js/addParty.js}"></script>
<script type="text/javascript" th:src="@{/js/addMember.js}"></script>
<script type="text/javascript" th:src="@{/js/deleteMember.js}"></script>

<script type="text/javascript" th:inline="javascript">
var userlist=[];
var userpartyAttendCount = [];

var dateLabel = $('#selectedDate').val();

var memberAttendCount = [[${memberAttendCount}]];
for(var u in memberAttendCount){			
	userlist.push(memberAttendCount[u][0]);
	userpartyAttendCount.push(memberAttendCount[u][1]);
}	

window.onload=function(){
	
	/* 
	var chart = new Chart(ctx, {
	    type: 'bar',
	    data: {
	        labels: userlist,
	        datasets: [{
	            label: dateLabel+" 월",
	            backgroundColor: 'rgb(255, 99, 132)',
	            borderColor: 'rgb(255, 99, 132)',
	            data: userpartyAttendCount
	        }]
	    },
	});
	 */
	
	var	ctx = document.getElementById('myChart').getContext('2d');
	
	
	 
	var data = {
        labels: userlist,
        datasets: [{
            label: dateLabel+" 월",
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: userpartyAttendCount
        }]
    };
	
	
	new Chart(ctx).Bar(data, {
        onAnimationComplete: function () {
            var sourceCanvas = this.chart.ctx.canvas;
            var copyWidth = this.scale.xScalePaddingLeft - 5;
            var copyHeight = this.scale.endPoint -10;
            var targetCtx = document.getElementById("myChartAxis").getContext("2d");
            targetCtx.canvas.width = copyWidth;
            targetCtx.drawImage(sourceCanvas, 0, 0, copyWidth, copyHeight, 0, 0, copyWidth, copyHeight);
        }
    });
	
}

/* 

var	ctx = document.getElementById('myChart').getContext('2d');
var userlist=[];
var userpartyAttendCount = [];

var dateLabel = $('#selectedDate').val();

var memberAttendCount = [[${memberAttendCount}]];
for(var u in memberAttendCount){			
	userlist.push(memberAttendCount[u][0]);
	userpartyAttendCount.push(memberAttendCount[u][1]);
}	

var chart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: userlist,
        datasets: [{
            label: dateLabel+" 월",
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: userpartyAttendCount
        }]
    },
});

 */


//pie
   // Load google charts
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);

var pieUserData = [];
pieUserData.push(['Task', 'Hours per Day'])
for(var i=0; i<userlist.length; i++){
	pieUserData.push([userlist[i], userpartyAttendCount[i]] );
}

// Draw the chart and set the chart values
function drawChart() {
  var data = google.visualization.arrayToDataTable(pieUserData);

  // Optional; add a title and set the width and height of the chart
  var options = {'title':dateLabel+" 월",'width':300, 'height':300};

  // Display the chart inside the <div> element with id="piechart"
  var chart = new google.visualization.PieChart(document.getElementById('piechart'));
  chart.draw(data, options);
}	

</script>


</html>
